from tabulate import tabulate
from math import *

h4 = 1.0/2**4
h5 = 1.0/2**5
h6 = 1.0/2**6
h7 = 1.0/2**7

k5 = log(1.3163e-02/5.2664e-02)/log(h5/h4)
k6 = log(3.3736e-03/1.3163e-02)/log(h6/h5)
k7 = log(9.4819e-04/3.3736e-03)/log(h7/h6)

u0 = [ ["1/2^4", 5.2664e-02, 1.3641e-02, 4.8979e-03, 3.7563e-03, 0.0],
    ["1/2^5", 5.1383e-02, 1.3163e-02, 3.7493e-03, 2.0471e-03, k5],
    ["1/2^6", 5.0991e-02, 1.2931e-02, 3.3736e-03, 1.2572e-03, k6],
    ["1/2^7", 5.0980e-02, 1.2863e-02, 3.2606e-03, 9.4819e-04, k7] ]

p0 = [ ["1/2^4", 2.1916e-02, 2.1959e-02, 2.1963e-02, 2.1964e-02],
    ["1/2^5", 1.1070e-02, 1.1100e-02, 1.1103e-02, 1.1104e-02],
    ["1/2^6", 5.5560e-03, 5.5794e-03, 5.5814e-03, 5.5816e-03],
    ["1/2^7", 2.7834e-03, 2.7965e-03, 2.7980e-03, 2.7982e-03] ]

print "-----------"
print "Errors for w_exact = (0.0, 0.0)"
print "||u - u_exact||_H1"
print tabulate (u0, headers = ["dt\N", "2^4", "2^5", "2^6", "2^7", "rate"])
print "||p - p_exact||_L2"
print tabulate (p0, headers = ["dt\N", "2^4", "2^5", "2^6", "2^7", "rate"])

# ---------------

u1 = [ ["1/2^4", 7.6567e-02, 5.3559e-02, 5.1754e-02, 5.1643e-02],
    ["1/2^5", 7.0160e-02, 4.5284e-02, 4.3173e-02, 4.3039e-02],
    ["1/2^6", 6.7901e-02, 4.2068e-02, 3.9834e-02, 3.9691e-02],
    ["1/2^7", 0.0, 0.0, 0.0, 0.0] ]

p1 = [ ["1/2^4", 4.1692e-02, 4.1580e-02, 4.1572e-02, 4.1573e-02],
    ["1/2^5", 3.0294e-02, 3.0177e-02, 3.0169e-02, 3.0169e-02],
    ["1/2^6", 2.4812e-02, 2.4697e-02, 2.4689e-02, 2.4689e-02],
    ["1/2^7", 0.0, 0.0, 0.0, 0.0] ]

w1 = [ ["1/2^4", 2.0038e-01, 2.0039e-01, 2.0039e-01, 2.0039e-01],
    ["1/2^5", 2.0037e-01, 2.0039e-01, 2.0039e-01, 2.0039e-01],
    ["1/2^6", 2.0037e-01, 2.0039e-01, 2.0039e-01, 2.0039e-01],
    ["1/2^7", 0.0, 0.0, 0.0, 0.0] ]


print "-----------"
print "Errors for w_exact = (C*sin(2*pi*x)*cos(t), 0.0)"
print "||u - u_exact||_H1"
print tabulate (u1, headers = ["dt\N", "2^4", "2^5", "2^6", "2^7"])
print "||p - p_exact||_L2"
print tabulate (p1, headers = ["dt\N", "2^4", "2^5", "2^6", "2^7"])
print "||w - w_exact||_H1"
print tabulate (w1, headers = ["dt\N", "2^4", "2^5", "2^6", "2^7"])